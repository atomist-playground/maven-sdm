configuration:
  logging:
    level: info
  sdm:
    cache:
      enabled: true
      path: /tmp/cache
    goal:
      timeout: 1200000

immaterial:
  test:
  - not:
      is_material_change:
        files:
        - package.json
        - Dockerfile
        extensions:
        - ts
  goals: lock

node_build:
  test:
  - has_file: package.json
  goals:
  - atomist/version-goal@0.0.1
  - atomist/npm-goal/npm-test@0.0.1
  - atomist/npm-goal/npm-publish@0.0.1:
      parameters:
        access: public
  - tag

docker_build:
  test:
  - has_file: package.json
  - has_file: Dockerfile
  depends_on:
  - node_build
  goals:
  - atomist/docker-goal/docker-build-push@0.0.1:
      parameters:
        registry: atomist
      input:
      - version
      - npm-test
