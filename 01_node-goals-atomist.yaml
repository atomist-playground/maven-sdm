configuration:
  logging:
    level: info
  sdm:
    cache:
      enabled: true
      path: /tmp/cache
    goal:
      timeout: 1200000

immaterial:
  test:
  - not:
      is_material_change:
        files:
        - package.json
        - Dockerfile
        extensions:
        - ts
  goals: lock

node_build:
  test:
  - has_file: package.json
  goals:
  - atomist/version-goal@a03a4cf
  - atomist/npm-goal/test@bea07cd
  - atomist/npm-goal/publish@bea07cd:
      parameters:
        access: public
  - tag

docker_build:
  test:
  - has_file: package.json
  - has_file: Dockerfile
  depends_on:
  - node_build
  goals:
  - atomist/docker-goal/build-push@7dd51f4:
      parameters:
        registry: atomist
      input:
      - version
      - npm-test
