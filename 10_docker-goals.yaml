docker_build:    
  test: 
  - has_file: Dockerfile  
    
  depends_on: 
  - mvn_build
  - node_build
         
  goals:   
  - containers:   
    - name: kaniko
      image: gcr.io/kaniko-project/executor
      args: 
      - --context=dir:///atm/home
      - --destination=atomist/${push.repo.name}:${push.after.sha}
      - --dockerfile=Dockerfile
      - --cache=true
      - --cache-repo=atomist/layer-cache
    input: 
    - cache
