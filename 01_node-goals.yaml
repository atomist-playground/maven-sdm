node\Ubuild:  
  test: 
  - has\Ufile: package.json
     
  goals:
  - containers:
    - name: npm-version
      image: ${env.version\Ugoal\Uimage}
    output:
    - classifier: version
      pattern:
        glob\Upattern:
        - package.json
  - containers:
    - name: npm-test
      image: node:8-slim
      env:
      - name: NODE\UENV
        value: development
      - name: BLUEBIRD\UWARNINGS
        value: '0'
      #- name: MONGODB\UURI
      #  value: mongodb://mongo:27017/test
      args:
      - sh
      - -c
      - npm ci && npm test
    - name: mongo
      image: mongo:3.6
      test:
      - has\Ufile\Ucontaining:
          glob\Upattern: package.json
          content: mongoose|connect-mongo
  input:
  - version
  output:
  - classifier: cache
    pattern:
      directory: node\Umodules
