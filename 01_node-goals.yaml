node_build:  
  test: 
  - has_file: package.json
     
  goals:   
  - containers:  
    - name: npm-test   
      image: node:8-slim 
      env: 
      - name: NODE_ENV 
        value: development
      - name: BLUEBIRD_WARNINGS
        value: '0'
      #- name: MONGODB_URI
      #  value: mongodb://mongo:27017/test
      args:
      - sh
      - -c
      - npm ci && npm test
    - name: mongo
      image: mongo:3.6
    output:
    - classifier: cache
      pattern:
        directory: node_modules
