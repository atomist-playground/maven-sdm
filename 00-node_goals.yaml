node_build:  
  test: 
  - hasFile: package.json
     
  goals:   
  - containers:  
    - name: npm-test   
      image: node:8-slim 
      env: 
      - name: NODE_ENV 
        value: development
      - name: MONGODB_URI
        value: mongodb://mongo:27017/test
      args:
      - sh
      - -c
      - npm ci && npm test
      docker_options:
      - '--link=mongo:mongo'
    - name: mongo
      image: mongo:latest
    output:
    - classifier: cache
      pattern:
        directory: node_modules
